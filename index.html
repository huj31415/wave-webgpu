<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>2D Wave Simulation on WebGPU</title>
  <link rel="stylesheet" href="./style.css">
</head>

<body>
  <canvas id="canvas"></canvas>
  <button id="toggleSettings">&gt;</button>
  <div id="controls" class="right-dark">
    <h2>2D Scalar Wave on WebGPU</h2>
    FPS: <span id="fps"></span>
    Frame time: <span id="frameTime"></span> ms
    <br>
    JS time: <span id="jsTime"></span> ms
    <div class="control-group">
      <div>
        <select id="visualization">
          <option value="wave">Wave</option>
          <option value="speed">Speed</option>
          <option value="end">End screen intensity</option>
        </select>
        <label for="visualization">Visualization mode</label>
      </div>
      <div>
        <input id="boundaryAbsorb" type="checkbox" checked>
        <label for="boundaryAbsorb">Absorbing boundary condition</label>
      </div>
      <div>
        <input id="dt" type="range" min="0.01" max="0.7" step="0.01" value="0.2">
        <label for="dt">dt &lt;1/(c&radic;2):
          <span id="dtValue">0.2</span>
        </label>
        <br>
        <input id="simSpeed" type="range" min="0" max="100" step="1" value="10">
        <label for="simSpeed">dt/frame:
          <span id="simSpeedValue">10</span>
        </label>
      </div>
      <button id="reinit" class="fullwidth">Restart sim</button>
    </div>
    <hr>
    <div class="control-group">
      <div>
        <input id="planeWave" type="radio" name="waveType" checked>
        <label for="planeWave">Plane wave</label>
        <br>
        <input id="pointSource" type="radio" name="waveType">
        <label for="pointSource">Point source</label>
      </div>
      <div>
        <input id="wavelength" type="range" min="6" max="100" step="2" value="10">
        <label for="wavelength">Wavelength:
          <span id="wavelengthValue">10</span>
        </label>
        <br>
        <input id="amplitude" type="range" min="0" max="5" step="0.1" value="1">
        <label for="amplitude">Amplitude:
          <span id="amplitudeValue">1</span>
        </label>
      </div>
      <button id="waveToggle" class="fullwidth">Toggle wave generator</button>
    </div>
    <hr>
    <div class="control-group" id="presetSettings">
      <div>
        <select id="preset">
          <option value="slits">Slit interference</option>
          <option value="lens">Lens</option>
          <option value="circularReflector">Circular reflector</option>
          <option value="parabolicReflector">Parabolic reflector</option>
        </select>
        <label for="preset">Preset</label>
      </div>
      <div>
        <div id="dsSettings" class="">
          <input id="dsNumSlits" type="range" min="1" max="10" step="1" value="2">
          <label for="dsNumSlits">Number of slits</label>
          <input id="dsWidthSlider" type="range" min="0" max="100" step="2" value="20">
          <label for="dsWidthSlider">Slit width:
            <span id="dsWidthValue">20</span>
          </label>
          <input id="dsSpacingSlider" type="range" min="10" max="1000" step="2" value="200">
          <label for="dsSpacingSlider">Slit spacing:
            <span id="dsSpacingValue">200</span>
          </label>
        </div>
        <div id="lensSettings" class="hidden">
          <p>Better at shorter wavelengths (&lt;10)</p>
          <form id="lensOptions">
            <span class="halfWidth">
              <input id="lensElliptical" type="radio" name="lensShape" value="elliptical" checked>
              <label for="lensElliptical">Elliptical</label>
              <br>
              <input id="lensParabolic" type="radio" name="lensShape" value="parabolic">
              <label for="lensParabolic">Parabolic</label>
            </span>
            <span class="halfWidth">
              <input id="lensConvex" type="radio" name="lensCurve" value="convex" checked>
              <label for="lensConvex">Convex</label>
              <br>
              <input id="lensConcave" type="radio" name="lensCurve" value="concave">
              <label for="lensConcave">Concave</label>
            </span>
            <span class="halfWidth">
              <input id="lensNormal" type="radio" name="lensType" value="normal" checked>
              <label for="lensNormal">Normal</label>
              <br>
              <input id="lensFresnel" type="radio" name="lensType" value="fresnel">
              <label for="lensFresnel">Fresnel</label>
            </span>
          </form>
          <input id="lensRadiusSlider" type="range" min="0" max="1000" step="10" value="300">
          <label for="lensRadiusSlider">Lens radius:
            <span id="lensRadiusValue">300</span>
          </label>
          <input id="lensARSlider" type="range" min="1" max="10" step=".1" value="4">
          <label for="lensARSlider">Aspect ratio:
            <span id="lensARValue">4</span>
          </label>
          <input id="lensDRSlider" type="range" min="2" max="10" step=".1" value="2">
          <label for="lensDRSlider">Fresnel depth:
            <span id="lensDRValue">2</span>
          </label>
          <input id="lensDir" type="range" min="-1" max="1" step="1" value="0">
          <label for="lensDir">Half-lens</label>
          <input id="lensIRSlider" type="range" min="0.25" max="4" step="0.05" value="1.2">
          <label for="lensIRSlider">Refraction idx:
            <span id="lensIRValue">1.20</span>
          </label>
        </div>
        <div id="rSettings" class="hidden">
          <input id="rRadiusSlider" type="range" min="10" max="1000" step="2" value="1000">
          <label for="rRadiusSlider">Width:
            <span id="rRadiusValue">1000</span>
          </label>
          <br>
          <input id="rDir" type="checkbox">
          <label for="rDir">Reverse direction</label>
        </div>
        <input id="offsetLeftSlider" type="range" min="0" max="1000" step="1" value="200">
        <label for="offsetLeftSlider">Left offset:
          <span id="offsetLeftValue">200</span>
        </label>
      </div>
      <button id="loadPreset" class="fullwidth">Load preset</button>
    </div>
    <hr>
    <div class="control-group">
      <p>Click/drag on the canvas to draw barriers</p>
      <div>
        <input id="drawnBarrierAbsorb" type="checkbox">
        <label for="drawnBarrierAbsorb">New barriers absorb</label>
      </div>
    </div>
    <hr>
    <div class="control-group">
      <div>
        <label for="barrierUpload">Upload image</label>
        <input id="barrierUpload" type="file" accept="image/*">
      </div>
      <div>
        <input id="blackIRSlider" type="range" min="0.25" max="4" step="0.05" value="1">
        <label for="blackIRSlider">Black refract:
          <span id="blackIRValue">1.00</span>
        </label>
        <input id="whiteIRSlider" type="range" min="0.25" max="4" step="0.05" value="1.5">
        <label for="whiteIRSlider">White refract:
          <span id="whiteIRValue">1.50</span>
        </label>
        <br>
        <input id="imageScale" type="range" min="0.1" max="1" step="0.05" value=".5">
        <label for="imageScale">Image scale</label>
      </div>
      <div>
        <input id="barrierInvert" type="checkbox">
        <label for="barrierInvert">Invert image</label>
      </div>
      <div>
        <input id="blockTop" type="checkbox">
        <label for="blockTop">Block top</label>
      </div>
      <div>
        <input id="blockBottom" type="checkbox">
        <label for="blockBottom">Block bottom</label>
      </div>
      <div>
        <button id="applyBarrierImage">Apply image</button>
        <button id="clearBarriers">Clear barriers</button>
      </div>
    </div>
    <p></p>
  </div>
  <script src="./wavegpu.js"></script>
</body>

</html>